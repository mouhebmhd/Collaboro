<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Collaboro | Listes des  Tâches </title>
  <link rel="stylesheet" href="/assets/css/style.css">
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/assets/js/projects.js"></script>
</head>
<body >
  <div class="container-scroller  ">
    <!--navbar start-->
    <nav class="navbar  fixed-top navbar-light shadow-sm  d-flex  align-items-center ">
    <a class="navbar-brand " href="/dashboard">
      <img src="/assets/img/logo.png"  class="d-inline-block align-top"> </a>
      <ul class="nav justify-content-end ">
        <li class="nav-item navbar-item">
          <a class="nav-link count-indicator " href="/chat">
            <i class="bi bi-envelope-fill mr-5 "></i>
            <span class="count1"></span>
          </a>
        </li>
        <li class="nav-item navbar-item">
          <a class="nav-link count-indicator " href="/notification">
            <i class="bi bi-bell-fill mr-4 "></i>
            <span class="count"></span>
          </a>
        </li>
        <li class="nav-item  mr-5 navbar-item">
          <a class="nav-link profile-photo " href="/EditMyProfile/<%= data._id%>"><img src="<%=data.photo%>" >
          </a>
        </li>

      
      </ul>
  </nav>

    <!--navbar end-->
    <div class="container-fluid page-body-wrapper">
      <!--sidebar start-->
      <nav class="sidebar shadow flex-row align-items-start mx-0 px-0  " id="sidebar">
    <ul class="nav" id="sidebar">
      <li class="nav-item nav-link">
          <button onclick="toggleNavbar()" class="btn btn-lg  " id="btnToggler"><i class="bi bi-arrow-return-left"></i></button>
      </li>
      <li class="nav-item  ">
        <a class="nav-link" href="/dashboard">
          <i class="bi bi-grid"></i>
          <span class="menu-title mx-2">Acceuil</span>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/projets"  >
          <i class="bi bi-code-square"></i>
          <span class="menu-title mx-2 ">Projets</span>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/sprints"  >
          <i class="bi bi-code-square"></i>
          <span class="menu-title mx-2 ">Sprints</span>
        </a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" data-toggle="collapse" href="/taches" >
          <i class="bi bi-list-task"></i>
          <span class="menu-title mx-2">Tâches</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/meeting">
          <i class="bi bi-camera-video"></i>
          <span class="menu-title mx-2 ">Meeting</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/chat">
          <i class="bi bi-chat-left"></i>
          <span class="menu-title mx-2">Chat</span>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/notification">
          <i class="bi bi-bell"></i>
          <span class="menu-title mx-2">Notification</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/EditMyProfile">
          <i class="bi bi-people"></i>
          <span class="menu-title mx-2">Profil</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/documentation">
          <i class="bi bi-book"></i>
          <span class="menu-title mx-2">Documentation</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/logout">
          <i class="bi bi-box-arrow-left"></i>
          <span class="menu-title mx-2">Déconnexion</span>
        </a>
      </li>
    </ul>
</nav>
      <nav class="mobile-sidebar shadow  flex-row align-items-start mx-0 px-0    " id="mobile-sidebar">
    <ul class="nav" >
      <li class="nav-item">
        <button onclick="toggleNavbar()" class="btn btn-lg " id="btnToggler"><i class="bi bi-arrow-return-right"></i></button>
      </li>
      <li class="nav-item  ">
        <a class="nav-link" href="/dashboard">
          <i class="bi bi-grid"></i>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/projets"  >
          <i class="bi bi-code-square"></i>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/sprints"  >
          <i class="bi bi-arrow-repeat"></i>
        </a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" data-toggle="collapse" href="/taches" >
          <i class="bi bi-list-task"></i>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/meeting">
          <i class="bi bi-camera-video"></i>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/chat">
          <i class="bi bi-chat-left"></i>
        </a>
      </li>
      <li class="nav-item ">
        <a class="nav-link" data-toggle="collapse" href="/notification">
          <i class="bi bi-bell"></i>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/EditMyProfile">
          <i class="bi bi-people"></i>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/documentation">
          <i class="bi bi-book"></i>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="/logout">
          <i class="bi bi-box-arrow-left"></i>
        </a>
      </li>
    </ul>
</nav>

        <!--sidebar end-->
        <div class=" container-fluid main-panel" id=main-panel-home >
          <div class="content-wrapper" id="main-panel-wrapper">
            <div class="row d-flex justify-content p-1">
              <h5><span class="title text-dark">Identifiant User Story:  <span class="PageTitle userStoryIdentifier"><%=story._id%></span></span></h5>
            </div>
            <div class="row d-flex justify-content-between ">
              <button type="button " class="btn  hideShow-button  ml-4" onclick="toggleTasks()"><i class="bi bi-arrow-bar-up" id="toggle-tasks-button" ></i></button>
              <a type="button" class="btn add-button mr-3 text-light" onclick="addNewTask()">Nouvelle Tâche <i class="bi bi-plus-lg ml-1 "></i></a>
            </div>
            <!--First row start-->
            
            <!--first row end -->
         <!--Second row start-->
            <div class="row mt-2 " id="tasks-grid">
              <div class="card col-12 my-2 tasks-grid">
                <div class="card-body">
                  <h4 class="card-title">Listes des Tâches</h4>
                  <div class="table-responsive">
                    <table class="table ">
                      <thead>
                            <th>Numéro</th>
                            <th>Tâche</th>
                            <th>Statut</th>
                            <th>Affecté à</th>
                            <th>Priorité</th>
                            <th>Actions</th>
                      </thead>
                      <tbody id="tachesListe">
                        <%if(taches.length>0)
                        {
                          for(var i=0;i<taches.length;i++)
                            {%>
                              <tr class="task">
                                <td><%=i+1%></td>
                                <td><%=taches[i].description%></td>
                                <td ><%=taches[i].statut%></td>
                                <td><%=ressigned.ressigned[i].prenom%> <%=ressigned.ressigned[i].nom%></td>
                                <td><%=taches[i].estimation%></td>
                                <td>
                                  <a type="button" class="btn btn-outline-danger deleteTaskButton text-danger " id="<%=taches[i]._id%>"><i class="bi bi-trash"></i></a>
                                  <a type="button" class="btn btn-outline-warning updateTaskButton text-warning  " id="<%=taches[i]._id%>"><i class="bi bi-tools"></i></a>
      
                                </td>
                              </tr>
                            <%}}%>
                        <tr class="taskModel d-none" id="taskModel">
                          <td ><span id="taskIdentifier">Identifiant </span></td>
                          <td><input type="text" class="form-control" id="descriptionTaches" placeholder="Description de tâche..."></td>
                          <td>En Attente(Par défaut)</td>
                          <td>
                            <select name="affected" id="affectedTo" class="affectedTo form-control">
                              <option value="Affecter cet tache à" selected disabled>Affecter Cette tâche à</option>
                              <%if(developers.length>0)
                              {
                                for(var j=0; j<developers.length; j++)
                                {%>
                                  <option value="<%=personalData[j]._id%>"><%=personalData[j].nom%> <%=personalData[j].prenom%></option>
                                <%}
                              }
                              %>
                              <option value="<%=sm._id%>"><%=sm.nom%> <%=sm.prenom%></option>
                            </select>
                          </td>
                          <td><input type="number" class="form-control" id="prioriteTaches" min="0" placeholder="Priorité de tâche (Par défaut 1)"></td>
                          <td>
                            <a  type="button" class="btn btn-outline-success addTaskButton text-success" onclick="saveNewTask(event)" id="" ><i class="bi bi-check2-all"></i></a>
                          </td>
                        </tr>
                        <tr class="taskUpdateModel d-none" id="taskUpdateModel">
                          <td ><span id="taskIdentifier">Identifiant </span></td>
                          <td><input type="text" class="form-control" id="descriptionTaches" placeholder="Description de tâche..."></td>
                          <td>En Attente(Par défaut)</td>
                          <td>
                            <select name="affected" id="affectedTo" class="affectedTo form-control">
                              <option value="Affecter cet tache à" selected disabled>Affecter Cette tâche à</option>
                              <option value="<%=sm._id%>">Mouheb Mehdoui</option>
                              <%if(developers.length>0)
                              {
                                for(var j=0; j<developers.length; j++)
                                {%>
                                  <option value="<%=personalData[j]._id%>"><%=personalData[j].nom%> <%=personalData[j].prenom%></option>
                                <%}
                              }
                              %>
                              <option value="<%=sm._id%>"><%=sm.nom%> <%=sm.prenom%></option>
                            </select>
                          </td>
                          <td><input type="number" class="form-control" id="prioriteTaches" min="0" placeholder="Priorité de tâche (Par défaut 1)"></td>
                          <td>
                            <a  type="button" class="btn btn-outline-success taskUpdateButton text-success" onclick="updateExistingTask(event)" id="" ><i class="bi bi-check2-all"></i></a>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          <!--Second row end-->
         </div>
         

       </div>
  </div>
  </div>

</body>    
<script src="/assets/js/navbar.js" ></script>
<script src="/assets/js/tasks.js" ></script>
</html>